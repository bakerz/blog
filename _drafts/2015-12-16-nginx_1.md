---
title: Nginx 端口映射访问
category: 技术
tags: Nginx
---

## default.conf

`/etc/nginx/sites-enabled` 下的配置文件

```nginx
upstream qzf {
    server 127.0.0.1:3000;
    keepalive 64;
}
server {
    listen 80;
    server_name www.qzfny.com qzfny.com;
    access_log /var/log/nginx/qzf.log;
    location / {
        proxy_set_header   X-Real-IP            $remote_addr;
        proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
        proxy_set_header   Host                   $http_host;
        proxy_set_header   X-NginX-Proxy    true;
        proxy_set_header   Connection "";
        proxy_http_version 1.1;
        proxy_pass         http://qzf;
    }
}
```

## window 中 nginx 的启动和关闭方法

```bash
start nginx

nginx -s stop

# 查看进程
tasklist /fi "imagename eq nginx.exe"

# 关闭进程
taskkill /fi "imagename eq nginx.exe" /f
```

## Vue 项目使用 history 模式路由，Nginx 部署后刷新页面 404

添加 try_files 配置：

```nginx
server {

  location / {
    root   /usr/share/nginx/html;
    index  index.html index.htm;
    try_files $uri $uri/ @router;
  }

  location @router {
    rewrite ^(.+)$ /index.html last;
  }
}
```

## Mac 安装 Nginx

[mac 下安装 nginx 及相关配置](https://www.cnblogs.com/tugenhua0707/p/9863885.html)

[MAC 下安装 nginx](https://segmentfault.com/a/1190000016020328/)

[mac 上安装 Nginx 详细教程](https://www.jianshu.com/p/4f433d219ab7)

## 关于 context

`/usr/local/Cellar/nginx/1.23.1/html` 下两个文件夹 project01、project02

```nginx
server {

  location / {
    root   html;
    index  index.html index.htm;
  }

  location /project01 {
    alias html/project01;
    index index.html;
  }

  location /project02 {
    alias html/project02;
    index index.html;
  }
}
```

[【自用笔记】nginx 配置多 context 及简单负载均衡](https://blog.csdn.net/qq12547345/article/details/125421182)

## 参考

[vue 项目 history 路由，F5 刷新页面，页面 404 问题，nginx try_files 解决方案](https://blog.csdn.net/qq_26003101/article/details/111873243)

CentOS 7 之前的命令：

```text
service nginx start

service nginx stop

service nginx restart
```

CentOS 7+ 命令：

```text
systemctl stop nginx

systemctl status nginx

systemctl start nginx

# 添加开机启动
systemctl enable nginx

# 查看开机启动服务
systemctl list-unit-files | grep enable
```

[CentOS 7 下使用 yum 安装 Nginx](https://blog.csdn.net/J080624/article/details/78087813) ⭐️

[Nginx 学习笔记（七）如何解决 nginx: [emerg] bind() to [::]:80 failed (98: Address already in use)](https://www.cnblogs.com/tinywan/p/8127822.html) ⭐️

端口相关命令：

```bash
$ netstat -lnp | grep 80
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      30269/nginx: master
tcp6       0      0 :::80                   :::*                    LISTEN      30269/nginx: master
tcp6       0      0 :::8080                 :::*                    LISTEN      1885/PM2 v5.2.2: Go

$ kill -9 30269
```
